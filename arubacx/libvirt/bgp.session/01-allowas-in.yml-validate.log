[session_v4]   Check IPv4 EBGP sessions with dut [ node(s): x1,x2,x3 ]
[PASS]         x1: Neighbor 172.16.0.1 (dut) is in state Established
[PASS]         x2: Neighbor 172.16.1.1 (dut) is in state Established
[PASS]         x3: Neighbor 172.16.2.1 (dut) is in state Established
[PASS]         Test succeeded

[session_v6]   Check IPv6 EBGP sessions with dut [ node(s): x1,x2,x3 ]
[PASS]         x1: Neighbor 2001:db8:4::1 (dut) is in state Established
[PASS]         x2: Neighbor 2001:db8:4:1::1 (dut) is in state Established
[PASS]         x3: Neighbor 2001:db8:4:2::1 (dut) is in state Established
[PASS]         Test succeeded

[pfx_v4_allow] Check whether DUT disabled AS check on IPv4 EBGP session with X2 [ node(s): x1 ]
[PASS]         x1: The prefix 172.42.42.0/24 is in the BGP table
[PASS]         Test succeeded

[pfx_v6_allow] Check whether DUT disabled AS check on IPv6 EBGP session with X2 [ node(s): x1 ]
[PASS]         x1: The prefix 2001:db8:a01::/64 is in the BGP table
[PASS]         Test succeeded

[pfx_v4_deny]  Check whether DUT still performs AS check on IPv4 EBGP session with X3 [ node(s): x1 ]
[WAITING]      Waiting for BGP convergence (retrying for 5 seconds)
[FAIL]         x1: The prefix 172.42.43.0/24 should not be in the BGP table
Returned result
================================================================================
advertisedTo:
  172.16.0.1: {}
paths:
- aspath:
    length: 2
    segments:
    - list:
      - 65000
      - 65102
      type: as-sequence
    string: 65000 65102
  bestpath:
    bestpathFromAs: 65000
    overall: true
    selectionReason: First path received
  lastUpdate:
    epoch: 1714406913
    string: 'Mon Apr 29 16:08:33 2024

      '
  nexthops:
  - accessible: true
    afi: ipv4
    ip: 172.16.0.1
    metric: 0
    used: true
  origin: IGP
  peer:
    peerId: 172.16.0.1
    routerId: 10.0.0.1
    type: external
  valid: true
  version: 4
prefix: 172.42.43.0/24
version: 4


[pfx_v6_deny]  Check whether DUT still performs AS check on IPv6 EBGP session with X3 [ node(s): x1 ]
[WAITING]      Waiting for BGP convergence (retrying for 5 seconds)
[FAIL]         x1: The prefix 2001:db8:a02::/64 should not be in the BGP table
Returned result
================================================================================
advertisedTo:
  2001:db8:4::1: {}
paths:
- aspath:
    length: 2
    segments:
    - list:
      - 65000
      - 65102
      type: as-sequence
    string: 65000 65102
  bestpath:
    bestpathFromAs: 65000
    overall: true
    selectionReason: First path received
  lastUpdate:
    epoch: 1714406913
    string: 'Mon Apr 29 16:08:33 2024

      '
  nexthops:
  - accessible: true
    afi: ipv6
    ip: 2001:db8:4::1
    metric: 0
    scope: global
  - accessible: true
    afi: ipv6
    ip: fe80::800:901:48e:681f
    scope: link-local
    used: true
  origin: IGP
  peer:
    peerId: 2001:db8:4::1
    routerId: 10.0.0.1
    type: external
  valid: true
  version: 2
prefix: 2001:db8:a02::/64
version: 2


[FAIL]         Tests completed, validation failed
