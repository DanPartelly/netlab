[session]   Check EBGP sessions with dut [ node(s): x1,x2,x3 ]
[PASS]      x1: Neighbor 10.1.0.1 (dut) is in state Established
[PASS]      x2: Neighbor 10.1.0.5 (dut) is in state Established
[PASS]      x3: Neighbor 10.1.0.9 (dut) is in state Established
[PASS]      Test succeeded

[pfx_allow] Check whether DUT disabled AS check on EBGP session with X2 [ node(s): x1 ]
[PASS]      x1: The prefix 172.42.42.0/24 is in the BGP table
[PASS]      Test succeeded

[pfx_deny]  Check whether DUT still performs AS check on EBGP session with X3 [ node(s): x1 ]
[FAIL]      x1: The prefix 172.42.43.0/24 should not be in the BGP table
Returned result
================================================================================
advertisedTo:
  10.1.0.1: {}
paths:
- aspath:
    length: 2
    segments:
    - list:
      - 65000
      - 65102
      type: as-sequence
    string: 65000 65102
  bestpath:
    bestpathFromAs: 65000
    overall: true
    selectionReason: First path received
  lastUpdate:
    epoch: 1714037231
    string: 'Thu Apr 25 09:27:11 2024

      '
  nexthops:
  - accessible: false
    afi: ipv4
    importCheckEnabled: true
    ip: 10.1.0.1
    used: true
  origin: IGP
  peer:
    peerId: 10.1.0.1
    routerId: 10.0.0.1
    type: external
  processScheduled: true
  removed: true
  valid: false
  version: 4
prefix: 172.42.43.0/24
version: 4


[FAIL]      Tests completed, validation failed
