[session] Check BGP sessions with DUT1 [ node(s): r1,r2,rr2,x1 ]
[PASS]    x1: Neighbor 2001:db8:3:3::1 (dut) is in state Established
[WAITING] Wait for BGP sessions to be established (retrying for 40 seconds)
[PASS]    r1: Neighbor 2001:db8:1:1::1 (dut) is in state Established
[WAITING] Wait for BGP sessions to be established (24 seconds left)
[PASS]    r2: Neighbor 2001:db8:1:1::1 (dut) is in state Established
[PASS]    rr2: Neighbor 2001:db8:1:1::1 (dut) is in state Established
[PASS]    Succeeded in 16.5 seconds
[PASS]    Test succeeded

[prefix]  Check whether DUT1 propagates the external beacon prefix [ node(s): r1,r2,rr2 ]
[PASS]    r1: The prefix 2001:db8:cafe:e::1/64 is in the BGP table
[PASS]    rr2: The prefix 2001:db8:cafe:e::1/64 is in the BGP table
[WAITING] Wait for BGP convergence (retrying for 5 seconds)
[PASS]    r2: The prefix 2001:db8:cafe:e::1/64 is in the BGP table
[PASS]    Succeeded in 1.4 seconds
[PASS]    Test succeeded

[nhs]     Check next-hop handling on DUT [ node(s): r1,r2 ]
[WAITING] Wait for BGP convergence (retrying for 5 seconds)
[FAIL]    r1: The next hop(s) for prefix 2001:db8:cafe:e::1/64 is/are 2001:db8:3:3::2,2001:db8:3:3::2, not 2001:db8:1:1::1
Returned result
================================================================================
paths:
- aspath:
    length: 1
    segments:
    - list:
      - 65101
      type: as-sequence
    string: '65101'
  bestpath:
    bestpathFromAs: 65101
    overall: true
    selectionReason: Cluster length
  lastUpdate:
    epoch: 1716970471
    string: 'Wed May 29 08:14:31 2024

      '
  locPrf: 100
  metric: 0
  nexthops:
  - accessible: true
    afi: ipv6
    ip: 2001:db8:3:3::2
    metric: 0
    scope: global
    used: true
  origin: IGP
  peer:
    peerId: 2001:db8:1:1::1
    routerId: 10.0.0.1
    type: internal
  valid: true
  version: 11
- aspath:
    length: 1
    segments:
    - list:
      - 65101
      type: as-sequence
    string: '65101'
  clusterList:
    list:
    - 10.0.0.43
  lastUpdate:
    epoch: 1716970476
    string: 'Wed May 29 08:14:36 2024

      '
  locPrf: 100
  metric: 0
  nexthops:
  - accessible: true
    afi: ipv6
    hostname: rr2
    ip: 2001:db8:3:3::2
    metric: 0
    scope: global
    used: true
  origin: IGP
  originatorId: 10.0.0.1
  peer:
    hostname: rr2
    peerId: 2001:db8:1:2::1
    routerId: 10.0.0.2
    type: internal
  valid: true
  version: 11
prefix: 2001:db8:cafe:e::/64
version: 11

[FAIL]    r2: The next hop(s) for prefix 2001:db8:cafe:e::1/64 is/are 2001:db8:3:3::2,2001:db8:3:3::2, not 2001:db8:1:1::1
Returned result
================================================================================
paths:
- aspath:
    length: 1
    segments:
    - list:
      - 65101
      type: as-sequence
    string: '65101'
  bestpath:
    bestpathFromAs: 65101
    overall: true
    selectionReason: Cluster length
  lastUpdate:
    epoch: 1716970476
    string: 'Wed May 29 08:14:36 2024

      '
  locPrf: 100
  metric: 0
  nexthops:
  - accessible: true
    afi: ipv6
    ip: 2001:db8:3:3::2
    metric: 0
    scope: global
    used: true
  origin: IGP
  peer:
    peerId: 2001:db8:1:1::1
    routerId: 10.0.0.1
    type: internal
  valid: true
  version: 18
- aspath:
    length: 1
    segments:
    - list:
      - 65101
      type: as-sequence
    string: '65101'
  clusterList:
    list:
    - 10.0.0.43
  lastUpdate:
    epoch: 1716970476
    string: 'Wed May 29 08:14:36 2024

      '
  locPrf: 100
  metric: 0
  nexthops:
  - accessible: true
    afi: ipv6
    hostname: rr2
    ip: 2001:db8:3:3::2
    metric: 0
    scope: global
    used: true
  origin: IGP
  originatorId: 10.0.0.1
  peer:
    hostname: rr2
    peerId: 2001:db8:1:2::1
    routerId: 10.0.0.2
    type: internal
  valid: true
  version: 18
prefix: 2001:db8:cafe:e::/64
version: 18


[reflect] Check route reflection on DUT [ node(s): r2 ]
[PASS]    r2: The prefix 2001:db8:cafe:1::/64 is in the BGP table
[PASS]    Test succeeded

[inact]   Check route reflection of inactive routes on DUT [ node(s): r2 ]
[PASS]    r2: The prefix 2001:db8:1:a::/64 is in the BGP table
[PASS]    Test succeeded

[nhu]     Check next-hop handling of reflected routes [ node(s): r2 ]
[PASS]    r2: One of the next hops for prefix 2001:db8:cafe:1::/64 is 2001:db8:1:a::1
[PASS]    Test succeeded

[cluster] Check cluster-id attribute in the BGP update from RR [ node(s): r2 ]
[PASS]    r2: Cluster ID 10.0.0.42 found in at least one path for prefix 2001:db8:cafe:1::/64
[PASS]    Test succeeded

[FAIL]    Tests completed, validation failed
